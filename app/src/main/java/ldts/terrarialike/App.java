/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package ldts.terrarialike;

import ldts.terrarialike.GUI.GUILanterna;
import ldts.terrarialike.controller.AbstractStateController;
import ldts.terrarialike.exceptions.InvalidPositionException;
import ldts.terrarialike.exceptions.NotInitializedStateException;
import ldts.terrarialike.statemanager.State;
import ldts.terrarialike.statemanager.StateManager;
import ldts.terrarialike.view.menus.MainMenuView;
import ldts.terrarialike.view.StateView;

import java.io.IOException;

public class App {

    @SuppressWarnings("InfiniteLoopStatement")
    public static void main(String[] args) throws InterruptedException, InvalidPositionException, IOException, NotInitializedStateException {
        GUILanterna gLanterna = new GUILanterna(200,100, "TerrariaLike");

        StateManager manager = new StateManager();
        State gameMenuState = new State(Object.class,MainMenuView.class,Object.class);

        gameMenuState.initializeDataClass();
        gameMenuState.initializeControllerClass();
        gameMenuState.initializeViewClass(manager, gLanterna);

        manager.addState(gameMenuState);
        manager.selectState(gameMenuState);


        while (true){
            StateView view = manager.getSelectedState().getViewObject(StateView.class);
            AbstractStateController stateController = null;
            //not necessary for all states ig
            try{
                stateController = manager.getSelectedState().getControllerObject(AbstractStateController.class);
                stateController.tick();
            } catch (ClassCastException ignored){

            }
            view.draw();
            gLanterna.refresh();
            Thread.sleep(100);
        }
    }
}
